apiVersion: batch/v1
kind: Job
metadata:
  name: experiment-api-migration
  namespace: experiment-backend
spec:
  template:
    spec:
      serviceAccountName: experiment-api
      containers:
      - name: migration
        image: experiment-backend:latest
        command: ["npm", "run", "seed"]
        envFrom:
        - configMapRef:
            name: experiment-api-config
        - secretRef:
            name: experiment-api-secrets
      restartPolicy: Never
  backoffLimit: 3
